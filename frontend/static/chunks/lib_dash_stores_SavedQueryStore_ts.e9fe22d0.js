"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkaxiom_local_dash"] = self["webpackChunkaxiom_local_dash"] || []).push([["lib_dash_stores_SavedQueryStore_ts"],{

/***/ 65212:
/*!********************************************!*\
  !*** ./lib/dash/stores/SavedQueryStore.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"SavedQueryStore\": () => (/* binding */ SavedQueryStore),\n/* harmony export */   \"mapStarredQueryWithIdQuery\": () => (/* binding */ mapStarredQueryWithIdQuery)\n/* harmony export */ });\n/* harmony import */ var lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash/cloneDeep */ 99748);\n/* harmony import */ var lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var lodash_remove__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash/remove */ 52144);\n/* harmony import */ var lodash_remove__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lodash_remove__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var mobx__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! mobx */ 50265);\n/* harmony import */ var _components_Notification__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../components/Notification */ 2022);\n/* harmony import */ var _shared_dash__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../shared/dash */ 81002);\n/* harmony import */ var _util_browserHistory__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../util/browserHistory */ 66257);\n/* harmony import */ var _util_urls__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../util/urls */ 37295);\n/* harmony import */ var _StoreBase__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./StoreBase */ 53769);\n/* harmony import */ var _UserStatusStore__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./UserStatusStore */ 41582);\n/* harmony import */ var _ViewStore__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ViewStore */ 77776);\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __rest = (undefined && undefined.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\n\n\n\n\n\n\n\n\n\n\nconst PAGE_SIZE = 50;\nconst mapStarredQueryWithIdQuery = (anyQuery) => {\n    const query = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_0___default()(anyQuery);\n    const sanitizeFilter = (filter) => {\n        if (!filter) {\n            return;\n        }\n        const { op, value, children } = filter;\n        // Ops that shouldn't have value (null or otherwise)\n        if (op === 'exists' || op === 'not-exists' || op === 'and' || op === 'or') {\n            delete filter.value;\n            // Other filters should all have some value (even if null)\n        }\n        else if (value === undefined) {\n            filter.value = null;\n        }\n        // Recursively sanitize\n        if (children) {\n            children.forEach(sanitizeFilter);\n        }\n    };\n    sanitizeFilter(query.filter);\n    return query;\n};\nclass SavedQueryStore extends _StoreBase__WEBPACK_IMPORTED_MODULE_3__.StoreBase {\n    constructor() {\n        super(...arguments);\n        // Operations trackers\n        this.addSavedQueryOps = new _StoreBase__WEBPACK_IMPORTED_MODULE_3__.SimpleOperationsTracker('addSavedQuery');\n        this.deleteSavedQueryOps = new _StoreBase__WEBPACK_IMPORTED_MODULE_3__.OperationsTracker();\n        this.getSavedQueriesOps = new _StoreBase__WEBPACK_IMPORTED_MODULE_3__.SimpleOperationsTracker('getSavedQueries');\n        this.updateSavedQueryOps = new _StoreBase__WEBPACK_IMPORTED_MODULE_3__.OperationsTracker();\n        this.hasMore = false;\n        this.pageFrom = 0;\n        this.savedQueries = [];\n        this.mapSavedQuery = (query) => {\n            var _a;\n            return {\n                id: query.id,\n                dataset: query.dataset,\n                metadata: query.metadata,\n                query: query.query,\n                queryType: query.kind,\n                type: 'saved',\n                name: query.name,\n                createdBy: query.who,\n                isMine: ((_a = _UserStatusStore__WEBPACK_IMPORTED_MODULE_4__.userStatusStore.user) === null || _a === void 0 ? void 0 : _a.id) === query.who,\n                created: new Date(query.created).getTime(),\n            };\n        };\n    }\n    getSavedQueries(query) {\n        // Store the query so we can set the tab\n        this.lastQuery = query;\n        // clearing the saved queries so that tabs won't show the wrong data\n        this.savedQueries = [];\n        // Clear the operation so we don't see a none found message\n        this.getSavedQueriesOps.removeOperation('getSavedQueries');\n        const { pageSize } = query, otherQuery = __rest(query, [\"pageSize\"]);\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        this.operate(this.getSavedQueriesOps.operation, _shared_dash__WEBPACK_IMPORTED_MODULE_5__.dashApi.getStarredQueries(Object.assign(Object.assign({}, otherQuery), { limit: pageSize || PAGE_SIZE })), (results) => {\n            // Protect against old TitleCase vfields\n            const matches = results.filter((r) => { var _a; return ((_a = r.data) === null || _a === void 0 ? void 0 : _a.ID) === undefined; });\n            this.hasMore = matches.length === PAGE_SIZE;\n            this.pageFrom = matches.length;\n            this.savedQueries = matches.map(this.mapSavedQuery);\n        });\n    }\n    loadMoreSavedQueries() {\n        if (!this.lastQuery) {\n            throw new Error('lastQuery not set before calling loadMoreSavedQueries');\n        }\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        this.operate(this.getSavedQueriesOps.operation, _shared_dash__WEBPACK_IMPORTED_MODULE_5__.dashApi.getStarredQueries(Object.assign(Object.assign({}, this.lastQuery), { limit: PAGE_SIZE, offset: this.pageFrom })), (results) => {\n            // Protect against old TitleCase vfields\n            const matches = results.filter((r) => { var _a; return ((_a = r.data) === null || _a === void 0 ? void 0 : _a.ID) === undefined; });\n            this.hasMore = matches.length === PAGE_SIZE;\n            this.pageFrom += matches.length;\n            this.savedQueries.push(...matches.map(this.mapSavedQuery));\n        });\n    }\n    addSavedQuery(query, onSuccessRemoveQSParams, autoCloseOperation) {\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        this.operate(autoCloseOperation || this.addSavedQueryOps.operation, _shared_dash__WEBPACK_IMPORTED_MODULE_5__.dashApi.createStarred(this.mapSavedQueryToPayload(query)), (addedSavedQuery) => {\n            this.savedQueries.push(this.mapSavedQuery(addedSavedQuery));\n            this.updateUrlQueryString(addedSavedQuery.id, query.queryType, onSuccessRemoveQSParams);\n        }, true);\n    }\n    updateSavedQuery(id, query, updateQueryString, onSuccessRemoveQSParams, operationPrefix, autoCloseOperation) {\n        // Optimistically update the query.\n        const savedQuery = this.savedQueries.find((sq) => sq.id === id);\n        if (!savedQuery) {\n            throw Error('Saved query not found');\n        }\n        // Make a copy so we can revert on error.\n        const originalQuery = (0,mobx__WEBPACK_IMPORTED_MODULE_2__.toJS)(savedQuery);\n        Object.assign(savedQuery, query);\n        const operation = autoCloseOperation || this.updateSavedQueryOps.getOrAddOperation(`${operationPrefix || ''}${id}`);\n        const toastId = `updateSavedQuery-${id}`;\n        _components_Notification__WEBPACK_IMPORTED_MODULE_6__.notification.dismiss(toastId);\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        this.operate(operation, _shared_dash__WEBPACK_IMPORTED_MODULE_5__.dashApi.updateStarred(id, this.mapSavedQueryToPayload(query)), (updatedSavedQuery) => {\n            if (updateQueryString) {\n                // Add the search Id to the Url\n                this.updateUrlQueryString(id, query.queryType, onSuccessRemoveQSParams);\n            }\n        }, undefined, (0,mobx__WEBPACK_IMPORTED_MODULE_2__.action)((error) => {\n            // Revert edits.\n            Object.assign(savedQuery, originalQuery);\n            _components_Notification__WEBPACK_IMPORTED_MODULE_6__.notification.error({\n                message: 'Failed to Save',\n                description: 'Failed to update saved search',\n            }, {\n                autoClose: false,\n                toastId: toastId,\n            });\n        }));\n    }\n    deleteSavedQuery(savedQueryId) {\n        const operation = this.deleteSavedQueryOps.getOrAddOperation(savedQueryId);\n        const toastId = `deleteSavedQuery-${savedQueryId}`;\n        _components_Notification__WEBPACK_IMPORTED_MODULE_6__.notification.dismiss(toastId);\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        this.operate(operation, _shared_dash__WEBPACK_IMPORTED_MODULE_5__.dashApi.deleteStarred(savedQueryId), () => {\n            lodash_remove__WEBPACK_IMPORTED_MODULE_1___default()(this.savedQueries, (sg) => sg.id === savedQueryId);\n        }, undefined, (error) => {\n            _components_Notification__WEBPACK_IMPORTED_MODULE_6__.notification.error({\n                message: 'Failed to Delete',\n                description: 'Failed to delete saved search',\n            }, {\n                autoClose: false,\n                toastId: toastId,\n            });\n        });\n    }\n    getStarred(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const query = this.savedQueries.find((sq) => sq.id === id);\n            if (query) {\n                return Promise.resolve(query);\n            }\n            return _shared_dash__WEBPACK_IMPORTED_MODULE_5__.dashApi.getStarred(id);\n        });\n    }\n    clearSavedQueryErrors(id) {\n        this.deleteSavedQueryOps.clearErrors(id);\n        this.updateSavedQueryOps.clearErrors(id);\n        _components_Notification__WEBPACK_IMPORTED_MODULE_6__.notification.dismiss(`deleteSavedQuery-${id}`);\n        _components_Notification__WEBPACK_IMPORTED_MODULE_6__.notification.dismiss(`updateSavedQuery-${id}`);\n    }\n    updateUrlQueryString(savedQueryId, queryType, onSuccessRemoveQSParams) {\n        // Add the Saved Query Id to the Url\n        const { activeQuery } = _ViewStore__WEBPACK_IMPORTED_MODULE_7__.viewStore;\n        const params = lodash_cloneDeep__WEBPACK_IMPORTED_MODULE_0___default()(activeQuery);\n        params.sid = savedQueryId;\n        if (queryType === 'analytics' || queryType === 'apl') {\n            params.skipQuery = '1'; // Indicate we don't want the query to re-execute.\n        }\n        if (onSuccessRemoveQSParams) {\n            onSuccessRemoveQSParams.forEach((param) => {\n                delete params[param];\n            });\n        }\n        _util_browserHistory__WEBPACK_IMPORTED_MODULE_8__.browserHistory.push(`${_util_browserHistory__WEBPACK_IMPORTED_MODULE_8__.browserHistory.location.pathname}${(0,_util_urls__WEBPACK_IMPORTED_MODULE_9__.stringifyWithQM)(params)}`);\n    }\n    mapSavedQueryToPayload(query, override) {\n        var _a;\n        return {\n            dataset: query.dataset,\n            metadata: query.metadata,\n            query: mapStarredQueryWithIdQuery(query.query),\n            kind: query.queryType,\n            name: query.name,\n            who: ((_a = _UserStatusStore__WEBPACK_IMPORTED_MODULE_4__.userStatusStore.user) === null || _a === void 0 ? void 0 : _a.id) || '',\n        };\n    }\n}\n__decorate([\n    mobx__WEBPACK_IMPORTED_MODULE_2__.observable\n], SavedQueryStore.prototype, \"hasMore\", void 0);\n__decorate([\n    mobx__WEBPACK_IMPORTED_MODULE_2__.observable\n], SavedQueryStore.prototype, \"pageFrom\", void 0);\n__decorate([\n    mobx__WEBPACK_IMPORTED_MODULE_2__.observable\n], SavedQueryStore.prototype, \"savedQueries\", void 0);\n__decorate([\n    mobx__WEBPACK_IMPORTED_MODULE_2__.observable\n], SavedQueryStore.prototype, \"lastQuery\", void 0);\n__decorate([\n    mobx__WEBPACK_IMPORTED_MODULE_2__.action.bound\n], SavedQueryStore.prototype, \"getSavedQueries\", null);\n__decorate([\n    mobx__WEBPACK_IMPORTED_MODULE_2__.action.bound\n], SavedQueryStore.prototype, \"loadMoreSavedQueries\", null);\n__decorate([\n    mobx__WEBPACK_IMPORTED_MODULE_2__.action.bound\n], SavedQueryStore.prototype, \"addSavedQuery\", null);\n__decorate([\n    mobx__WEBPACK_IMPORTED_MODULE_2__.action.bound\n], SavedQueryStore.prototype, \"updateSavedQuery\", null);\n__decorate([\n    mobx__WEBPACK_IMPORTED_MODULE_2__.action.bound\n], SavedQueryStore.prototype, \"deleteSavedQuery\", null);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDO0NBQ0Y7QUF4TkM7SUFEQyw0Q0FBVTtnREFDcUI7QUFHaEM7SUFEQyw0Q0FBVTtpREFDaUI7QUFHNUI7SUFEQyw0Q0FBVTtxREFDMkI7QUFHdEM7SUFEQyw0Q0FBVTtrREFDd0M7QUFHbkQ7SUFEQyw4Q0FBWTtzREF3Qlo7QUFHRDtJQURDLDhDQUFZOzJEQW1CWjtBQUdEO0lBREMsOENBQVk7b0RBYVo7QUFHRDtJQURDLDhDQUFZO3VEQWtEWjtBQUdEO0lBREMsOENBQVk7dURBNEJaIiwic291cmNlcyI6WyJmaWxlOi8vL1VzZXJzL3dhdGVybWVsb24vUHJvamVjdHMvQXhpb20vY29kZS9heGlvbWhxLWFwcC9mcm9udGVuZC9saWIvZGFzaC9zdG9yZXMvU2F2ZWRRdWVyeVN0b3JlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjbG9uZURlZXAgZnJvbSAnbG9kYXNoL2Nsb25lRGVlcCc7XG5pbXBvcnQgcmVtb3ZlIGZyb20gJ2xvZGFzaC9yZW1vdmUnO1xuaW1wb3J0IHsgYWN0aW9uLCBvYnNlcnZhYmxlLCB0b0pTIH0gZnJvbSAnbW9ieCc7XG5cbmltcG9ydCB7IG5vdGlmaWNhdGlvbiB9IGZyb20gJy4uL2NvbXBvbmVudHMvTm90aWZpY2F0aW9uJztcbmltcG9ydCB7XG4gIEFQTFJlcXVlc3RXaXRoT3B0aW9ucyxcbiAgZGFzaEFwaSxcbiAgRmlsdGVyLFxuICBRdWVyeVJlcXVlc3RXaXRoT3B0aW9ucyxcbiAgU3RhcnJlZFF1ZXJ5LFxuICBTdGFycmVkUXVlcnlXaXRoSWQsXG59IGZyb20gJy4uL3NoYXJlZC9kYXNoJztcbmltcG9ydCB7IGJyb3dzZXJIaXN0b3J5IH0gZnJvbSAnLi4vdXRpbC9icm93c2VySGlzdG9yeSc7XG5pbXBvcnQgeyBzdHJpbmdpZnlXaXRoUU0gfSBmcm9tICcuLi91dGlsL3VybHMnO1xuXG5pbXBvcnQgeyBIaXN0b3J5U2F2ZUFzS2luZCB9IGZyb20gJy4vUXVlcnlIaXN0b3J5U3RvcmUnO1xuaW1wb3J0IHsgT3BlcmF0aW9uLCBPcGVyYXRpb25zVHJhY2tlciwgU2ltcGxlT3BlcmF0aW9uc1RyYWNrZXIsIFN0b3JlQmFzZSB9IGZyb20gJy4vU3RvcmVCYXNlJztcbmltcG9ydCB7IHVzZXJTdGF0dXNTdG9yZSB9IGZyb20gJy4vVXNlclN0YXR1c1N0b3JlJztcbmltcG9ydCB7IHZpZXdTdG9yZSB9IGZyb20gJy4vVmlld1N0b3JlJztcblxuZXhwb3J0IHR5cGUgU3RhcnJlZFNhdmVBc0tpbmQgPSBIaXN0b3J5U2F2ZUFzS2luZDtcblxuY29uc3QgUEFHRV9TSVpFID0gNTA7XG5cbmV4cG9ydCBjb25zdCBtYXBTdGFycmVkUXVlcnlXaXRoSWRRdWVyeSA9IChhbnlRdWVyeTogYW55KSA9PiB7XG4gIGNvbnN0IHF1ZXJ5ID0gY2xvbmVEZWVwKGFueVF1ZXJ5KTtcblxuICBjb25zdCBzYW5pdGl6ZUZpbHRlciA9IChmaWx0ZXI6IEZpbHRlciB8IHVuZGVmaW5lZCkgPT4ge1xuICAgIGlmICghZmlsdGVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgeyBvcCwgdmFsdWUsIGNoaWxkcmVuIH0gPSBmaWx0ZXI7XG5cbiAgICAvLyBPcHMgdGhhdCBzaG91bGRuJ3QgaGF2ZSB2YWx1ZSAobnVsbCBvciBvdGhlcndpc2UpXG4gICAgaWYgKG9wID09PSAnZXhpc3RzJyB8fCBvcCA9PT0gJ25vdC1leGlzdHMnIHx8IG9wID09PSAnYW5kJyB8fCBvcCA9PT0gJ29yJykge1xuICAgICAgZGVsZXRlIGZpbHRlci52YWx1ZTtcblxuICAgICAgLy8gT3RoZXIgZmlsdGVycyBzaG91bGQgYWxsIGhhdmUgc29tZSB2YWx1ZSAoZXZlbiBpZiBudWxsKVxuICAgIH0gZWxzZSBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgZmlsdGVyLnZhbHVlID0gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBSZWN1cnNpdmVseSBzYW5pdGl6ZVxuICAgIGlmIChjaGlsZHJlbikge1xuICAgICAgY2hpbGRyZW4uZm9yRWFjaChzYW5pdGl6ZUZpbHRlcik7XG4gICAgfVxuICB9O1xuXG4gIHNhbml0aXplRmlsdGVyKHF1ZXJ5LmZpbHRlcik7XG5cbiAgcmV0dXJuIHF1ZXJ5O1xufTtcblxuZXhwb3J0IGludGVyZmFjZSBJbmplY3RlZFNhdmVkUXVlcnlTdG9yZSB7XG4gIHNhdmVkUXVlcnlTdG9yZTogU2F2ZWRRdWVyeVN0b3JlO1xufVxuXG5leHBvcnQgdHlwZSBRdWVyeUluZm9UeXBlID0gJ3NhdmVkJyB8ICdoaXN0b3J5JztcblxuZXhwb3J0IGludGVyZmFjZSBRdWVyeUluZm8ge1xuICBpZDogc3RyaW5nO1xuICBkYXRhc2V0Pzogc3RyaW5nO1xuICBtZXRhZGF0YTogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfTtcbiAgcXVlcnk6IFF1ZXJ5UmVxdWVzdFdpdGhPcHRpb25zIHwgQVBMUmVxdWVzdFdpdGhPcHRpb25zO1xuICBxdWVyeVR5cGU6IFN0YXJyZWRTYXZlQXNLaW5kO1xuICB0eXBlOiBRdWVyeUluZm9UeXBlO1xuICBuYW1lOiBzdHJpbmc7XG4gIGNyZWF0ZWRCeT86IHN0cmluZztcbiAgaXNNaW5lPzogYm9vbGVhbjtcbiAgY3JlYXRlZDogbnVtYmVyO1xufVxuXG5leHBvcnQgdHlwZSBVcGRhdGFibGVTYXZlZFF1ZXJ5ID0gUGljazxRdWVyeUluZm8sICdkYXRhc2V0JyB8ICdtZXRhZGF0YScgfCAnbmFtZScgfCAncXVlcnknIHwgJ3F1ZXJ5VHlwZSc+O1xuXG5leHBvcnQgaW50ZXJmYWNlIEdldFNhdmVkUXVlcmllc1F1ZXJ5IHtcbiAga2luZDogU3RhcnJlZFNhdmVBc0tpbmQ7XG4gIHFzPzogc3RyaW5nO1xuICBkYXRhc2V0Pzogc3RyaW5nO1xuICB3aG8/OiBzdHJpbmc7XG4gIHBhZ2VTaXplPzogbnVtYmVyO1xufVxuXG5leHBvcnQgY2xhc3MgU2F2ZWRRdWVyeVN0b3JlIGV4dGVuZHMgU3RvcmVCYXNlIHtcbiAgLy8gT3BlcmF0aW9ucyB0cmFja2Vyc1xuICBwdWJsaWMgYWRkU2F2ZWRRdWVyeU9wcyA9IG5ldyBTaW1wbGVPcGVyYXRpb25zVHJhY2tlcignYWRkU2F2ZWRRdWVyeScpO1xuICBwdWJsaWMgZGVsZXRlU2F2ZWRRdWVyeU9wcyA9IG5ldyBPcGVyYXRpb25zVHJhY2tlcigpO1xuICBwdWJsaWMgZ2V0U2F2ZWRRdWVyaWVzT3BzID0gbmV3IFNpbXBsZU9wZXJhdGlvbnNUcmFja2VyKCdnZXRTYXZlZFF1ZXJpZXMnKTtcbiAgcHVibGljIHVwZGF0ZVNhdmVkUXVlcnlPcHMgPSBuZXcgT3BlcmF0aW9uc1RyYWNrZXIoKTtcblxuICBAb2JzZXJ2YWJsZVxuICBwdWJsaWMgaGFzTW9yZTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIEBvYnNlcnZhYmxlXG4gIHB1YmxpYyBwYWdlRnJvbTogbnVtYmVyID0gMDtcblxuICBAb2JzZXJ2YWJsZVxuICBwdWJsaWMgc2F2ZWRRdWVyaWVzOiBRdWVyeUluZm9bXSA9IFtdO1xuXG4gIEBvYnNlcnZhYmxlXG4gIHB1YmxpYyBsYXN0UXVlcnk6IEdldFNhdmVkUXVlcmllc1F1ZXJ5IHwgdW5kZWZpbmVkO1xuXG4gIEBhY3Rpb24uYm91bmRcbiAgcHVibGljIGdldFNhdmVkUXVlcmllcyhxdWVyeTogR2V0U2F2ZWRRdWVyaWVzUXVlcnkpOiB2b2lkIHtcbiAgICAvLyBTdG9yZSB0aGUgcXVlcnkgc28gd2UgY2FuIHNldCB0aGUgdGFiXG4gICAgdGhpcy5sYXN0UXVlcnkgPSBxdWVyeTtcbiAgICAvLyBjbGVhcmluZyB0aGUgc2F2ZWQgcXVlcmllcyBzbyB0aGF0IHRhYnMgd29uJ3Qgc2hvdyB0aGUgd3JvbmcgZGF0YVxuICAgIHRoaXMuc2F2ZWRRdWVyaWVzID0gW107XG4gICAgLy8gQ2xlYXIgdGhlIG9wZXJhdGlvbiBzbyB3ZSBkb24ndCBzZWUgYSBub25lIGZvdW5kIG1lc3NhZ2VcbiAgICB0aGlzLmdldFNhdmVkUXVlcmllc09wcy5yZW1vdmVPcGVyYXRpb24oJ2dldFNhdmVkUXVlcmllcycpO1xuXG4gICAgY29uc3QgeyBwYWdlU2l6ZSwgLi4ub3RoZXJRdWVyeSB9ID0gcXVlcnk7XG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXG4gICAgdGhpcy5vcGVyYXRlKFxuICAgICAgdGhpcy5nZXRTYXZlZFF1ZXJpZXNPcHMub3BlcmF0aW9uLFxuICAgICAgZGFzaEFwaS5nZXRTdGFycmVkUXVlcmllcyh7IC4uLm90aGVyUXVlcnksIGxpbWl0OiBwYWdlU2l6ZSB8fCBQQUdFX1NJWkUgfSksXG4gICAgICAocmVzdWx0cykgPT4ge1xuICAgICAgICAvLyBQcm90ZWN0IGFnYWluc3Qgb2xkIFRpdGxlQ2FzZSB2ZmllbGRzXG4gICAgICAgIGNvbnN0IG1hdGNoZXMgPSByZXN1bHRzLmZpbHRlcigocikgPT4gKHIgYXMgYW55KS5kYXRhPy5JRCA9PT0gdW5kZWZpbmVkKTtcblxuICAgICAgICB0aGlzLmhhc01vcmUgPSBtYXRjaGVzLmxlbmd0aCA9PT0gUEFHRV9TSVpFO1xuICAgICAgICB0aGlzLnBhZ2VGcm9tID0gbWF0Y2hlcy5sZW5ndGg7XG4gICAgICAgIHRoaXMuc2F2ZWRRdWVyaWVzID0gbWF0Y2hlcy5tYXA8UXVlcnlJbmZvPih0aGlzLm1hcFNhdmVkUXVlcnkpO1xuICAgICAgfVxuICAgICk7XG4gIH1cblxuICBAYWN0aW9uLmJvdW5kXG4gIHB1YmxpYyBsb2FkTW9yZVNhdmVkUXVlcmllcygpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMubGFzdFF1ZXJ5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2xhc3RRdWVyeSBub3Qgc2V0IGJlZm9yZSBjYWxsaW5nIGxvYWRNb3JlU2F2ZWRRdWVyaWVzJyk7XG4gICAgfVxuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgIHRoaXMub3BlcmF0ZShcbiAgICAgIHRoaXMuZ2V0U2F2ZWRRdWVyaWVzT3BzLm9wZXJhdGlvbixcbiAgICAgIGRhc2hBcGkuZ2V0U3RhcnJlZFF1ZXJpZXMoeyAuLi50aGlzLmxhc3RRdWVyeSwgbGltaXQ6IFBBR0VfU0laRSwgb2Zmc2V0OiB0aGlzLnBhZ2VGcm9tIH0pLFxuICAgICAgKHJlc3VsdHMpID0+IHtcbiAgICAgICAgLy8gUHJvdGVjdCBhZ2FpbnN0IG9sZCBUaXRsZUNhc2UgdmZpZWxkc1xuICAgICAgICBjb25zdCBtYXRjaGVzID0gcmVzdWx0cy5maWx0ZXIoKHIpID0+IChyIGFzIGFueSkuZGF0YT8uSUQgPT09IHVuZGVmaW5lZCk7XG5cbiAgICAgICAgdGhpcy5oYXNNb3JlID0gbWF0Y2hlcy5sZW5ndGggPT09IFBBR0VfU0laRTtcbiAgICAgICAgdGhpcy5wYWdlRnJvbSArPSBtYXRjaGVzLmxlbmd0aDtcbiAgICAgICAgdGhpcy5zYXZlZFF1ZXJpZXMucHVzaCguLi5tYXRjaGVzLm1hcDxRdWVyeUluZm8+KHRoaXMubWFwU2F2ZWRRdWVyeSkpO1xuICAgICAgfVxuICAgICk7XG4gIH1cblxuICBAYWN0aW9uLmJvdW5kXG4gIHB1YmxpYyBhZGRTYXZlZFF1ZXJ5KHF1ZXJ5OiBVcGRhdGFibGVTYXZlZFF1ZXJ5LCBvblN1Y2Nlc3NSZW1vdmVRU1BhcmFtcz86IHN0cmluZ1tdLCBhdXRvQ2xvc2VPcGVyYXRpb24/OiBPcGVyYXRpb24pIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXG4gICAgdGhpcy5vcGVyYXRlKFxuICAgICAgYXV0b0Nsb3NlT3BlcmF0aW9uIHx8IHRoaXMuYWRkU2F2ZWRRdWVyeU9wcy5vcGVyYXRpb24sXG4gICAgICBkYXNoQXBpLmNyZWF0ZVN0YXJyZWQodGhpcy5tYXBTYXZlZFF1ZXJ5VG9QYXlsb2FkKHF1ZXJ5KSksXG4gICAgICAoYWRkZWRTYXZlZFF1ZXJ5KSA9PiB7XG4gICAgICAgIHRoaXMuc2F2ZWRRdWVyaWVzLnB1c2godGhpcy5tYXBTYXZlZFF1ZXJ5KGFkZGVkU2F2ZWRRdWVyeSkpO1xuXG4gICAgICAgIHRoaXMudXBkYXRlVXJsUXVlcnlTdHJpbmcoYWRkZWRTYXZlZFF1ZXJ5LmlkLCBxdWVyeS5xdWVyeVR5cGUsIG9uU3VjY2Vzc1JlbW92ZVFTUGFyYW1zKTtcbiAgICAgIH0sXG4gICAgICB0cnVlXG4gICAgKTtcbiAgfVxuXG4gIEBhY3Rpb24uYm91bmRcbiAgcHVibGljIHVwZGF0ZVNhdmVkUXVlcnkoXG4gICAgaWQ6IHN0cmluZyxcbiAgICBxdWVyeTogVXBkYXRhYmxlU2F2ZWRRdWVyeSxcbiAgICB1cGRhdGVRdWVyeVN0cmluZz86IGJvb2xlYW4sXG4gICAgb25TdWNjZXNzUmVtb3ZlUVNQYXJhbXM/OiBzdHJpbmdbXSxcbiAgICBvcGVyYXRpb25QcmVmaXg/OiBzdHJpbmcsXG4gICAgYXV0b0Nsb3NlT3BlcmF0aW9uPzogT3BlcmF0aW9uXG4gICkge1xuICAgIC8vIE9wdGltaXN0aWNhbGx5IHVwZGF0ZSB0aGUgcXVlcnkuXG4gICAgY29uc3Qgc2F2ZWRRdWVyeSA9IHRoaXMuc2F2ZWRRdWVyaWVzLmZpbmQoKHNxKSA9PiBzcS5pZCA9PT0gaWQpO1xuICAgIGlmICghc2F2ZWRRdWVyeSkge1xuICAgICAgdGhyb3cgRXJyb3IoJ1NhdmVkIHF1ZXJ5IG5vdCBmb3VuZCcpO1xuICAgIH1cbiAgICAvLyBNYWtlIGEgY29weSBzbyB3ZSBjYW4gcmV2ZXJ0IG9uIGVycm9yLlxuICAgIGNvbnN0IG9yaWdpbmFsUXVlcnkgPSB0b0pTKHNhdmVkUXVlcnkpO1xuICAgIE9iamVjdC5hc3NpZ24oc2F2ZWRRdWVyeSwgcXVlcnkpO1xuXG4gICAgY29uc3Qgb3BlcmF0aW9uID0gYXV0b0Nsb3NlT3BlcmF0aW9uIHx8IHRoaXMudXBkYXRlU2F2ZWRRdWVyeU9wcy5nZXRPckFkZE9wZXJhdGlvbihgJHtvcGVyYXRpb25QcmVmaXggfHwgJyd9JHtpZH1gKTtcblxuICAgIGNvbnN0IHRvYXN0SWQgPSBgdXBkYXRlU2F2ZWRRdWVyeS0ke2lkfWA7XG4gICAgbm90aWZpY2F0aW9uLmRpc21pc3ModG9hc3RJZCk7XG5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXG4gICAgdGhpcy5vcGVyYXRlKFxuICAgICAgb3BlcmF0aW9uLFxuICAgICAgZGFzaEFwaS51cGRhdGVTdGFycmVkKGlkLCB0aGlzLm1hcFNhdmVkUXVlcnlUb1BheWxvYWQocXVlcnkpKSxcbiAgICAgICh1cGRhdGVkU2F2ZWRRdWVyeSkgPT4ge1xuICAgICAgICBpZiAodXBkYXRlUXVlcnlTdHJpbmcpIHtcbiAgICAgICAgICAvLyBBZGQgdGhlIHNlYXJjaCBJZCB0byB0aGUgVXJsXG4gICAgICAgICAgdGhpcy51cGRhdGVVcmxRdWVyeVN0cmluZyhpZCwgcXVlcnkucXVlcnlUeXBlLCBvblN1Y2Nlc3NSZW1vdmVRU1BhcmFtcyk7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB1bmRlZmluZWQsXG4gICAgICBhY3Rpb24oKGVycm9yOiBhbnkpID0+IHtcbiAgICAgICAgLy8gUmV2ZXJ0IGVkaXRzLlxuICAgICAgICBPYmplY3QuYXNzaWduKHNhdmVkUXVlcnksIG9yaWdpbmFsUXVlcnkpO1xuXG4gICAgICAgIG5vdGlmaWNhdGlvbi5lcnJvcihcbiAgICAgICAgICB7XG4gICAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIFNhdmUnLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICdGYWlsZWQgdG8gdXBkYXRlIHNhdmVkIHNlYXJjaCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBhdXRvQ2xvc2U6IGZhbHNlLFxuICAgICAgICAgICAgdG9hc3RJZDogdG9hc3RJZCxcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICBAYWN0aW9uLmJvdW5kXG4gIHB1YmxpYyBkZWxldGVTYXZlZFF1ZXJ5KHNhdmVkUXVlcnlJZDogc3RyaW5nKSB7XG4gICAgY29uc3Qgb3BlcmF0aW9uID0gdGhpcy5kZWxldGVTYXZlZFF1ZXJ5T3BzLmdldE9yQWRkT3BlcmF0aW9uKHNhdmVkUXVlcnlJZCk7XG5cbiAgICBjb25zdCB0b2FzdElkID0gYGRlbGV0ZVNhdmVkUXVlcnktJHtzYXZlZFF1ZXJ5SWR9YDtcbiAgICBub3RpZmljYXRpb24uZGlzbWlzcyh0b2FzdElkKTtcblxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXNcbiAgICB0aGlzLm9wZXJhdGUoXG4gICAgICBvcGVyYXRpb24sXG4gICAgICBkYXNoQXBpLmRlbGV0ZVN0YXJyZWQoc2F2ZWRRdWVyeUlkKSxcbiAgICAgICgpID0+IHtcbiAgICAgICAgcmVtb3ZlKHRoaXMuc2F2ZWRRdWVyaWVzLCAoc2cpID0+IHNnLmlkID09PSBzYXZlZFF1ZXJ5SWQpO1xuICAgICAgfSxcbiAgICAgIHVuZGVmaW5lZCxcbiAgICAgIChlcnJvcjogYW55KSA9PiB7XG4gICAgICAgIG5vdGlmaWNhdGlvbi5lcnJvcihcbiAgICAgICAgICB7XG4gICAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIERlbGV0ZScsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJ0ZhaWxlZCB0byBkZWxldGUgc2F2ZWQgc2VhcmNoJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGF1dG9DbG9zZTogZmFsc2UsXG4gICAgICAgICAgICB0b2FzdElkOiB0b2FzdElkLFxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgcHVibGljIGFzeW5jIGdldFN0YXJyZWQoaWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHF1ZXJ5ID0gdGhpcy5zYXZlZFF1ZXJpZXMuZmluZCgoc3EpID0+IHNxLmlkID09PSBpZCk7XG5cbiAgICBpZiAocXVlcnkpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocXVlcnkpO1xuICAgIH1cblxuICAgIHJldHVybiBkYXNoQXBpLmdldFN0YXJyZWQoaWQpO1xuICB9XG5cbiAgcHVibGljIGNsZWFyU2F2ZWRRdWVyeUVycm9ycyhpZDogc3RyaW5nKSB7XG4gICAgdGhpcy5kZWxldGVTYXZlZFF1ZXJ5T3BzLmNsZWFyRXJyb3JzKGlkKTtcbiAgICB0aGlzLnVwZGF0ZVNhdmVkUXVlcnlPcHMuY2xlYXJFcnJvcnMoaWQpO1xuICAgIG5vdGlmaWNhdGlvbi5kaXNtaXNzKGBkZWxldGVTYXZlZFF1ZXJ5LSR7aWR9YCk7XG4gICAgbm90aWZpY2F0aW9uLmRpc21pc3MoYHVwZGF0ZVNhdmVkUXVlcnktJHtpZH1gKTtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlVXJsUXVlcnlTdHJpbmcoc2F2ZWRRdWVyeUlkOiBzdHJpbmcsIHF1ZXJ5VHlwZTogU3RhcnJlZFNhdmVBc0tpbmQsIG9uU3VjY2Vzc1JlbW92ZVFTUGFyYW1zPzogc3RyaW5nW10pIHtcbiAgICAvLyBBZGQgdGhlIFNhdmVkIFF1ZXJ5IElkIHRvIHRoZSBVcmxcbiAgICBjb25zdCB7IGFjdGl2ZVF1ZXJ5IH0gPSB2aWV3U3RvcmU7XG4gICAgY29uc3QgcGFyYW1zID0gY2xvbmVEZWVwKGFjdGl2ZVF1ZXJ5KTtcbiAgICBwYXJhbXMuc2lkID0gc2F2ZWRRdWVyeUlkO1xuICAgIGlmIChxdWVyeVR5cGUgPT09ICdhbmFseXRpY3MnIHx8IHF1ZXJ5VHlwZSA9PT0gJ2FwbCcpIHtcbiAgICAgIHBhcmFtcy5za2lwUXVlcnkgPSAnMSc7IC8vIEluZGljYXRlIHdlIGRvbid0IHdhbnQgdGhlIHF1ZXJ5IHRvIHJlLWV4ZWN1dGUuXG4gICAgfVxuICAgIGlmIChvblN1Y2Nlc3NSZW1vdmVRU1BhcmFtcykge1xuICAgICAgb25TdWNjZXNzUmVtb3ZlUVNQYXJhbXMuZm9yRWFjaCgocGFyYW0pID0+IHtcbiAgICAgICAgZGVsZXRlIHBhcmFtc1twYXJhbV07XG4gICAgICB9KTtcbiAgICB9XG4gICAgYnJvd3Nlckhpc3RvcnkucHVzaChgJHticm93c2VySGlzdG9yeS5sb2NhdGlvbi5wYXRobmFtZX0ke3N0cmluZ2lmeVdpdGhRTShwYXJhbXMpfWApO1xuICB9XG5cbiAgcHJpdmF0ZSBtYXBTYXZlZFF1ZXJ5ID0gKHF1ZXJ5OiBTdGFycmVkUXVlcnlXaXRoSWQpOiBRdWVyeUluZm8gPT4ge1xuICAgIHJldHVybiB7XG4gICAgICBpZDogcXVlcnkuaWQsXG4gICAgICBkYXRhc2V0OiBxdWVyeS5kYXRhc2V0LFxuICAgICAgbWV0YWRhdGE6IHF1ZXJ5Lm1ldGFkYXRhLFxuICAgICAgcXVlcnk6IHF1ZXJ5LnF1ZXJ5IGFzIGFueSwgLy8gSWdub3JlIHR5cGUgY29udmVyc2lvbiBlcnJvci5cbiAgICAgIHF1ZXJ5VHlwZTogcXVlcnkua2luZCBhcyBhbnksIC8vIElnbm9yZSB0eXBlIGNvbnZlcnNpb24gZXJyb3IuXG4gICAgICB0eXBlOiAnc2F2ZWQnLFxuICAgICAgbmFtZTogcXVlcnkubmFtZSxcbiAgICAgIGNyZWF0ZWRCeTogcXVlcnkud2hvLFxuICAgICAgaXNNaW5lOiB1c2VyU3RhdHVzU3RvcmUudXNlcj8uaWQgPT09IHF1ZXJ5LndobyxcbiAgICAgIGNyZWF0ZWQ6IG5ldyBEYXRlKHF1ZXJ5LmNyZWF0ZWQpLmdldFRpbWUoKSxcbiAgICB9O1xuICB9O1xuXG4gIHByaXZhdGUgbWFwU2F2ZWRRdWVyeVRvUGF5bG9hZChcbiAgICBxdWVyeTogT21pdDxRdWVyeUluZm8sICdpZCcgfCAnY3JlYXRlZCcgfCAnY3JlYXRlZEJ5JyB8ICd0eXBlJyB8ICdpc01pbmUnPixcbiAgICBvdmVycmlkZT86IGJvb2xlYW5cbiAgKTogU3RhcnJlZFF1ZXJ5IHtcbiAgICByZXR1cm4ge1xuICAgICAgZGF0YXNldDogcXVlcnkuZGF0YXNldCxcbiAgICAgIG1ldGFkYXRhOiBxdWVyeS5tZXRhZGF0YSxcbiAgICAgIHF1ZXJ5OiBtYXBTdGFycmVkUXVlcnlXaXRoSWRRdWVyeShxdWVyeS5xdWVyeSksXG4gICAgICBraW5kOiBxdWVyeS5xdWVyeVR5cGUgYXMgYW55LCAvLyBJZ25vcmUgdHlwZSBjb252ZXJzaW9uIGVycm9yLlxuICAgICAgbmFtZTogcXVlcnkubmFtZSxcbiAgICAgIHdobzogdXNlclN0YXR1c1N0b3JlLnVzZXI/LmlkIHx8ICcnLFxuICAgIH07XG4gIH1cbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///65212\n");

/***/ })

}]);